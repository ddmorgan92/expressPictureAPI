<!DOCTYPE html>
<html>

<head>
    <!--<script src="index.js" async></script>-->
    <style>
        ul {
            list-style: none;
        }
    </style>
</head>

<body>
    <form action="http://localhost:8080/pic/grayscale" method="POST">
        <input type="file" id="inputFileToLoad" accept="image/*" onchange="handleFiles();">
        <input type="text" id="base64container" name="base64"></input>
        <div id="imgUpload"></div>
    <button type="submit">Send to API</button>
</form>

    <script>
        var base64String = '';
        function handleFiles() {

            var filesSelected = document.getElementById("inputFileToLoad").files;
            if (filesSelected.length > 0) {
                var fileToLoad = filesSelected[0];

                var fileReader = new FileReader();

                fileReader.onload = function (fileLoadedEvent) {
                    var srcData = fileLoadedEvent.target.result; // <--- data: base64
                    base64String = srcData;

                    var newImage = document.createElement('img');
                    newImage.src = srcData;

                    document.getElementById("imgUpload").innerHTML = newImage.outerHTML;
                    console.log("base64String is: " + base64String);
                    document.getElementById("base64container").value = base64String;

                }
                fileReader.readAsDataURL(fileToLoad);
            }
        }

        // function sendPost(){
        //     var url = "http://localhost:8080/pic/grayscale";

        //     var xhr = new XMLHttpRequest();
        //     xhr.open("POST", url);

        //     // xhr.setRequestHeader("Accept", "application/json");
        //     // xhr.setRequestHeader("Content-Type", "application/json");

        //     xhr.onreadystatechange = function () {
        //     if (xhr.readyState === 4) {
        //         console.log(xhr.status);
        //         console.log(xhr.responseText);
        //     }};

        //     var data = `{
        //     "base64": "${base64String}"
        //     }`;

        //     xhr.send(data);
        // }
    </script>

</body>

</html>